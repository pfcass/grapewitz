<h1>Listing wines</h1>

<table>
  <tbody>
    <%= variety = '' %>
    <% @wines.each do |wine| %>
      <% if variety != wine.variety.name %>
          <%    variety = wine.variety.name %>
          <th><%= variety %><br></th>
      <%  end %>
      <tr>
        <td><%= wine.brand.name %></td>

        <td><%= link_to "Show My Bottles (#{wine.num_bottles(false, current_user.id)})",
                        wine_path(wine.id, :show_all => false )%></td>
        <td><%= link_to "Show All Bottles(#{wine.num_bottles(true, current_user.id)})",
                        wine_path(wine.id, :show_all => true )%></td>
        <td><%= link_to 'Add a Bottle', new_bottle_path(:wine_id => wine.id) %></td>
        <td><%= link_to 'Add a comment', edit_wine_path(wine) %></td>

        <% if wine.comments.first %>
            <td><%= link_to(wine.comments.first.comment,
                            edit_comment_path(:id => wine.comments.first.id)) %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Wine', new_wine_path %>
